<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Iron Meridian - Custom Item Ledger</title>
  <style>
    body {
      font-family: 'Garamond', 'Georgia', serif;
      background-color: #f4f0e6;
      color: #2c1b0b;
      padding: 2em;
    }
    h1 {
      text-align: center;
      color: #4b2c20;
    }
    .controls {
      margin-bottom: 1em;
      text-align: center;
    }
    select, input[type="text"] {
      padding: 0.5em;
      margin: 0.5em;
      font-size: 1em;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1em;
    }
    th, td {
      border: 1px solid #4b2c20;
      padding: 0.75em;
      text-align: left;
      vertical-align: top;
    }
    th {
      background-color: #d7cbbd;
      cursor: pointer;
    }
    tr:nth-child(even) {
      background-color: #f8f6f2;
    }
    .details {
      display: none;
      white-space: pre-wrap;
      font-size: 0.95em;
      background-color: #fbf9f5;
    }
    .expandable:hover {
      background-color: #eee4d9;
    }
    strong.item-name {
      font-size: 1.1em;
    }
    .detail-label {
      font-weight: bold;
      color: #4b2c20;
    }
  </style>
</head>
<body>
  <h1>ðŸ“˜ Iron Meridian - Custom Magic Item Ledger</h1>

  <div class="controls">
    <label for="filter">Filter by Type:</label>
    <select id="filter">
      <option value="">All</option>
      <option value="Worn">Worn</option>
      <option value="Wondrous">Wondrous</option>
      <option value="Consumable">Consumable</option>
      <option value="Alchemical">Alchemical</option>
      <option value="Weapon">Weapon</option>
    </select>
    <label for="search">Search:</label>
    <input type="text" id="search" placeholder="Search item names...">
  </div>

  <table>
    <thead>
      <tr>
        <th onclick="sortTable(0)">Item Name</th>
        <th onclick="sortTable(1)">Type</th>
        <th onclick="sortTable(2)">Level</th>
        <th>Effect Summary</th>
        <th onclick="sortTable(4)">Craft DC</th>
      </tr>
    </thead>
    <tbody id="item-table-body"></tbody>
  </table>

  <script>
    const itemData = [
      {
        "name": "Whispershard Sabers",
        "type": "Worn, Magical (Void Daggers)",
        "level": 5,
        "effect": `ðŸ§© Twin Void Daggers\nTraits: Agile, Finesse, Twin, Aberration, Mental, Invested\nDamage (each): 1d6 slashing + 1d4 mental\n+3 item bonus to attacks\nSword Crit Spec: Target becomes Off-Guard\n\nðŸŒ€ While Dual-Wielding:\nâ€¢ Resistance 2 to Mental\nâ€¢ Hitting with both sabers: Flat-Footed until next turn\nâ€¢ Crits emit psychic chittering (audible to Styx only)\n\nðŸ”® Synaptic Shear (1/day, 2 Actions):\nStrike with both sabers. If at least one hits, +1d4 mental and DC 17 Will Save:\nFail: Stupefied 1 (1 round)\nCrit Fail: Stupefied 2\nSuccess: No effect (still spooky)`,
        "craftDC": 21
      },
      {
        "name": "Obsidian Coin of the Cloakmark",
        "type": "Wondrous Item",
        "level": 2,
        "effect": "Functions as a badge of recognition; +1 to Stealth or Deception once per session in urban environments; unlocks secret NPC interactions.",
        "craftDC": 17
      },
      {
        "name": "Ancient Dwarven Rug",
        "type": "Wondrous Item (Unique)",
        "level": "â€”",
        "effect": "Encoded with hidden lore; may reveal secrets if studied. Can be restored to unlock powers.",
        "craftDC": "â€”"
      },
      {
        "name": "Echo Gem",
        "type": "Wondrous, Consumable",
        "level": 2,
        "effect": "Records a whispered phrase and replays it once per day. Currently stores... flatulence.",
        "craftDC": 14
      },
      {
        "name": "Moonstone Pendant",
        "type": "Worn, Magical",
        "level": 2,
        "effect": "Glows near undead; +1 vs mental/fear saves 1/day; reveals 1 spirit question if used in shrine (1/week).",
        "craftDC": 15
      },
      {
        "name": "Whispering Ring",
        "type": "Worn, Magical",
        "level": 3,
        "effect": "Cast Message at will; Calm Emotions 1/day (DC 16); faint background whispers when inactive.",
        "craftDC": 16
      },
      {
        "name": "Copperleaf Journal",
        "type": "Unique Lore Item (non-magical)",
        "level": "â€”",
        "effect": "â€“2 DC to Religion/Diplomacy checks vs Serelith; contains failed soul-retort ritual notes.",
        "craftDC": "â€”"
      },
      {
        "name": "Catalytic Core Shard",
        "type": "Alchemical Reagent",
        "level": 3,
        "effect": "+1 item bonus to Crafting acid/fire bombs; worth 25 gp.",
        "craftDC": 15
      },
      {
        "name": "Intact Alchemical Heart",
        "type": "Consumable, Alchemical Reagent",
        "level": 4,
        "effect": "Functions once as a Lesser Elemental Gem â€“ Fire; worth 50 gp.",
        "craftDC": 15
      },
      {
        "name": "Brannaâ€™s Bakefire Biscuits",
        "type": "Consumable, Alchemical, Food",
        "level": 1,
        "effect": "+1 to saves vs fatigue & fear for 1 hour; Crit = 1d8 healing.",
        "craftDC": 15
      },
      {
        "name": "Riverwarden's Aegis",
        "type": "Worn, Magical (Abjuration)",
        "level": 2,
        "effect": "+1 saves vs Redwater corruption; once/day chime grants +1 vs negative conditions for 1 min.",
        "craftDC": "â€”"
      },
      {
        "name": "Dried Moonpetal",
        "type": "Consumable, Herb (Non-magical)",
        "level": 1,
        "effect": "Brewed into tea grants +1 Will save vs fear for 1 hour.",
        "craftDC": 14
      },
      {
        "name": "Clockwork Bird with Shifting Plumage",
        "type": "Wondrous, Magical",
        "level": 2,
        "effect": "Wound with Thievery DC 10; shifts colors for 1 min; nearby allies get +1 to overcome minor negative condition.",
        "craftDC": 14
      },
{
  "name": "Void-Eater's Greataxe",
  "type": "Weapon, Magical (Evocation, Aberration, Mental)",
  "level": 6,
  "traits": ["Uncommon", "Evocation", "Aberration", "Invested", "Mental", "Weapon"],
  "baseWeapon": "Greataxe",
  "damage": "1d8 slashing + 1d6 mental",
  "attackBonus": "+5 item bonus to attack rolls",
  "proficiency": "Martial",
  "group": "Axe",
  "effect": `ðŸª“ Psychic Void Greataxe
Crafted from hardened Akata carapace, this greataxe hums with discordant psychic energy. Faint cosmic motes drift across its chitinous blades, and it emits low chittering when swung.

Passive (Invested):
â€¢ Gain Resistance 2 to Mental damage while wielded and invested.
â€¢ All Strikes include an additional 1d6 mental damage from psychic resonance.

ðŸ”® Void Resonance Slash (1/day, 2 Actions):
Make a Strike. If it hits, deal 1d8 slashing + 2d6 mental. Target must attempt a DC 16 Will save:
â€¢ âŒ Fail: Stupefied 1 for 1 round
â€¢ âŒ Crit Fail: Up to GM discretion
â€¢ âœ… Success: No effect (still unsettling)

Lore:
Forged from petrified essence of a great Akata, this axe slumbered for millennia beneath Sable Row. Its reawakening distorted reality, triggered the sinkhole, and drew nearby Akata like a beacon.`,
  "craftDC": 22,
  "bulk": 2,
  "usage": "Held in 2 hands",
  "lore": [
    "Crafted from ancient Akata remains, the axe was long buried beneath Sable Row in a forgotten Imperial vault.",
    "Its reawakening caused a subtle warp in the land, leading to the collapse that revealed it.",
    "Akata were drawn to its psychic hum across vast distances or planes."
  ],
  "value": "Unknown â€” likely a priceless Akata relic"
},
{
  "name": "Echo Cyst Familiar Core",
  "type": "Familiar Upgrade, Magical (Void, Mental)",
  "level": 4,
  "traits": ["Magical", "Void", "Mental", "Custom", "Familiar", "Invested"],
  "effect": `ðŸŒ‘ Void Echo Aura (Laszlo only)
â€¢ 15-foot emanation from Laszlo (the familiar)
â€¢ Enemies within take â€“1 to Will, Fortitude, and Reflex saves vs mental effects
â€¢ Aura hums with whispered chimesâ€”only audible to those with lingering guilt
â€¢ Quirk: Laszlo has started mimicking ObsidianIvy's sinister laugh

ðŸ› ï¸ Installed via cranial echo-socket and anchored bone-thread glyphs`,
  "craftDC": 21,
  "value": "125 gp (custom familiar core)",
  "usage": "Familiar upgrade (requires bat or suitable cranial cavity)",
  "bulk": "L (as installed item)",
  "installation": {
    "crafter": "ObsidianIvy",
    "familiar": "Laszlo the Bat ðŸ¦‡",
    "location": "Iron Meridian Guild Workshop",
    "timeSpent": "2 days",
    "skillUsed": "Arcana +9",
    "roll": "18 + 9 = 27",
    "materials": [
      "Residual whisperglass",
      "Bat-safe cranial implant resin",
      "Echo-threaded bone filament",
      "Crystallized drop of ObsidianIvyâ€™s voice"
    ]
  },
  "lore": [
    "Laszlo now contains an unstable yet non-hostile void symbiote.",
    "The aura affects enemiesâ€™ mental defenses with subtle emotional resonance.",
    "After awakening, Laszlo whispered: 'All things return to silence. Iâ€™m fine, thank you.'",
    "Solen Telvair refused to enter the room for 24 hours."
  ]
},
{
  "name": "Sommelier's Spectacles",
  "type": "Wondrous Item (Divination)",
  "level": 1,
  "traits": ["Uncommon", "Divination", "Worn", "Consumable", "Crafting"],
  "effect": `ðŸ‘“ Once per day, when worn:
â€¢ Grants a +1 item bonus to Crafting checks
â€¢ Applies only to tasks related to food, beverages, or alchemy
â€¢ Lens shimmer when identifying rare wines or cursed chutneys`,
  "craftDC": 14,
  "value": "8 gp",
  "usage": "Worn (eyewear)",
  "bulk": "L",
  "lore": [
    "A staple among high-end guild tasters and culinary artificers.",
    "Crafted by the eccentric diviner Gourmand Elvet, who claimed to 'taste the future through fermented fruit.'"
  ],
  "locationFound": "Area 3"
},
{
    "name": "Aural Dampener (Mk I)",
    "type": "Worn Gadget (Wondrous)",
    "level": 2,
    "traits": ["Uncommon","Auditory","Mental","Invested"],
    "effect": `ðŸŽ§ Field jammer against psi-noise
â€¢ While worn and invested: +1 circumstance bonus to Will saves vs. mental hazards and auditory psychic effects.
â€¢ Action â€” Activate (1 action): Until the start of your next turn, you ignore penalties from sustained â€œhumâ€/echo hazards.
Notes: Issued to Theta team (qty: 4). Reusable; requires 10 minutes to re-tune after heavy exposure.`,
    "craftDC": 17,
    "value": "15 gp",
    "usage": "Worn (headset/earcuff)",
    "bulk": "L"
  },
  {
    "name": "Mindâ€‘Shielding Amulet",
    "type": "Worn, Magical (Abjuration)",
    "level": 3,
    "traits": ["Uncommon","Abjuration","Invested"],
    "effect": `ðŸ›¡ï¸ Quietâ€‘mind charm
â€¢ While invested: +1 item bonus to Will saves vs. mental effects.
â€¢ 1/day â€” Mind Over Matter (free action): Gain Resistance 5 mental until start of your next turn.`,
    "craftDC": 19,
    "value": "55 gp",
    "usage": "Worn (necklace)",
    "bulk": "L"
  },
  {
    "name": "Ethereal Capacitor",
    "type": "Consumable, Wondrous (Technoâ€‘Occult)",
    "level": 3,
    "traits": ["Uncommon","Occult","Magitech","Consumable"],
    "effect": `âš¡ Beacon breaker (oneâ€‘use)
Interact to discharge within 10 ft of a psychic device, construct, or echoâ€‘hazard. Attempt a counteract vs. mental/occult effect at +9:
â€¢ Crit Success: Device shuts down 1 minute (or hazard disabled).
â€¢ Success: Suppressed 1 round; targets linked to it take â€“2 circumstance to checks/DCs that round.
â€¢ Failure: No effect. On a critical failure, you take 1d6 mental.`,
    "craftDC": 20,
    "value": "25 gp",
    "usage": "Held; Interact (discharge)",
    "bulk": "L"
  },
  {
    "name": "Hylasâ€™s Blade",
    "type": "Weapon, Magical (+1 Striking Bastard Sword)",
    "level": 4,
    "traits": ["Magical","Versatile"],
    "baseWeapon": "Bastard Sword",
    "damage": "2d8 slashing (twoâ€‘hand d12)",
    "attackBonus": "+1 item bonus (Striking rune)",
    "group": "Sword",
    "effect": `Austere, voidâ€‘etched greatblade once attuned to the Relayâ€™s cadence. While the wielder is affected by a mental effect, their first Strike each round against the source gains +1 status to damage.`,
    "craftDC": 19,
    "value": "100 gp",
    "usage": "1 or 2 hands",
    "bulk": 2
  },
  {
    "name": "Aetheric Clarity Brew",
    "type": "Consumable, Alchemical (Elixir)",
    "level": 2,
    "traits": ["Alchemical","Consumable"],
    "effect": `ðŸ§ª Drink to steady the signal
For 1 minute: +1 circumstance bonus to Will saves and Occultism checks vs. psychic/aberrant effects.`,
    "craftDC": 16,
    "value": "15 gp",
    "usage": "Drink",
    "bulk": "â€”"
  },
  {
    "name": "Cognitive Dampener",
    "type": "Consumable, Alchemical (Toxin/Elixir)",
    "level": 2,
    "traits": ["Alchemical","Ingested"],
    "effect": `âš ï¸ Mindâ€‘muddling draught
Fort DC 15 on ingest:
â€¢ Fail: Stupefied 1 for 1 hour.
â€¢ Crit Fail: Stupefied 2 for 10 minutes, then 1 for remainder.
â€¢ Success: No effect.`,
    "craftDC": 15,
    "value": "5 gp",
    "usage": "Drink",
    "bulk": "â€”"
  },
  {
    "name": "Vial of Unstable Chaos",
    "type": "Consumable, Alchemical (Experimental)",
    "level": 3,
    "traits": ["Uncommon","Alchemical","Consumable","Chaotic"],
    "effect": `ðŸŽ² Drink and roll 1d10:
1â€“3: Take 2d6 mental & Stupefied 1 (1 round).
4â€“6: Take 1d6 mental; gain one random arcane/occult cantrip for 10 minutes.
7â€“9: Resistance 5 mental for 1 hour.
10: Stabilizes â€” can be used once more for Resistance 5 effect.`,
    "craftDC": 19,
    "value": "20 gp",
    "usage": "Drink",
    "bulk": "â€”"
  },
  {
    "name": "Concentrated Psychic Residue",
    "type": "Consumable, Alchemical (Bomb)",
    "level": 3,
    "traits": ["Uncommon","Bomb","Mental","Thrown"],
    "effect": `ðŸ§  Throw (20 ft). On hit or in a 5â€‘ft burst: Will DC 15 or Stupefied 1 for 1 round (creatures already stupefied instead become offâ€‘guard until end of their next turn).`,
    "craftDC": 18,
    "value": "18 gp",
    "usage": "Held; thrown",
    "bulk": "â€”"
  },
  {
    "name": "Psionic Focus Amulet",
    "type": "Worn, Magical (Occult)",
    "level": 4,
    "traits": ["Uncommon","Invested","Occult"],
    "effect": `ðŸ§© Echoâ€‘tuned focus
â€¢ While invested: You can sense active psychic effects within 20 ft (vague tingle).
â€¢ 1/day â€” Mind Over Matter (free): Gain Resistance 5 mental for 1 round.`,
    "craftDC": 20,
    "value": "90 gp",
    "usage": "Worn (pendant)",
    "bulk": "L"
  },
  {
    "name": "Echoâ€‘Resonant Grenade",
    "type": "Consumable, Alchemical (Sonic/Psi)",
    "level": 3,
    "traits": ["Uncommon","Bomb","Sonic","Mental"],
    "effect": `ðŸ’£ Detonate (Throw 20 ft): 10â€‘ft burst of antiâ€‘harmonic noise.
Creatures in burst: â€“1 status to Will saves vs. mental effects for 1 round.
Active â€œechoâ€ hazards in burst: suppressed 1 round.`,
    "craftDC": 19,
    "value": "12 gp",
    "usage": "Thrown",
    "bulk": "â€”"
  },
  {
    "name": "Labyrinthâ€™s Signet Ring",
    "type": "Worn (Mundane)",
    "level": 0,
    "traits": ["Uncommon","Social"],
    "effect": `Silver signet bearing the skeletal hand of the Ivory Labyrinth.
â€¢ Grants +1 circumstance bonus to Deception checks to impersonate Labyrinth personnel (GM discretion; may provokeâ€¦ consequences).`,
    "craftDC": "â€”",
    "value": "35 gp",
    "usage": "Worn (ring)",
    "bulk": "â€”"
  },
  {
    "name": "Unstable Serum (Raw)",
    "type": "Alchemical Reagent",
    "level": 1,
    "traits": ["Alchemical","Reagent"],
    "effect": `Volatile psiâ€‘reactive base. When used as reagents for crafting mental/occult alchemy, grants +1 item bonus to the Crafting check.`,
    "craftDC": 14,
    "value": "3 gp (per vial)",
    "usage": "Crafting reagent",
    "bulk": "â€”"
  },
  {
    "name": "Ethereal Fluid (Refined)",
    "type": "Alchemical Reagent",
    "level": 1,
    "traits": ["Alchemical","Reagent"],
    "effect": `Shimmering phaseâ€‘tuned solvent. Counts as special material to meet occult component requirements; can substitute for a 5 gp reagent in eligible formulas.`,
    "craftDC": 14,
    "value": "5 gp (per vial)",
    "usage": "Crafting reagent",
    "bulk": "â€”"
  },
  {
    "name": "Runes of Animation â€” Field Notebook",
    "type": "Unique Lore Item (nonâ€‘magical)",
    "level": "â€”",
    "traits": ["Lore","Research"],
    "effect": `Schematics and ritual notes on echoâ€‘constructs.
â€¢ Research aid: +1 item bonus to Crafting checks to Repair/Disable constructs and to Occultism checks to Identify constructâ€‘related rituals (GM discretion).`,
    "craftDC": "â€”",
    "value": "25 gp (to the right buyer)",
    "usage": "Reference",
    "bulk": "L"
  },
  {
    "name": "Heart of the Highcourt",
    "type": "Artifact (Divination, Social)",
    "level": 10,
    "traits": ["Artifact", "Divination", "Magical", "Invested", "Uncommon"],
    "effect": "ðŸ’Ž Court-Sense Reliquary\nHeld aloft, the Heart drinks in whispers of intent. While held and invested:\nâ€¢ +2 item bonus to Diplomacy and Deception checks when interacting with nobles, courtiers, magistrates, or politicians.\nâ€¢ You can Sense Motive against such targets in half the usual time.\nâš ï¸ Complication: Repeated coercive use (GMâ€™s discretion) attracts attention from powerful factions who want the Heart claimed, sealed, or used.\nâœ¨ Table Prompt: The gem subtly reflects the targetâ€™s dominant color-emotion (envy green, zeal crimson, etc.).",
    "craftDC": 28,
    "usage": "Held in 1 hand (invested)",
    "bulk": "L",
    "value": "Unknown â€” artifact; sale discouraged",
    "lore": [
      "Once beat within the throne-dais of the Highcourt; stolen during the Last Audience.",
      "Courtiers swore it could taste ambition; several successions â€˜mysteriouslyâ€™ resolved after midnight audiences."
    ]
  },
  {
    "name": "Masquerade Sleep Draught",
    "type": "Alchemical Poison (Ingested)",
    "level": 5,
    "traits": ["Alchemical", "Poison", "Ingested", "Uncommon"],
    "effect": "ðŸŽ­ Velvet Nightcap (Ingested)\nSave DC 18 Fortitude.\nâ€¢ Success: The target becomes drowsy and sluggish for 10 minutes (GM: impose â€“1 status penalty to Perception and Will checks, or treat as â€˜fatigued lightâ€™ condition per table norm).\nâ€¢ Failure: Target falls unconscious for 1d6 hours. Only a specific runic reveille (or comparable magic: remove curse/neutralize poison at GM discretion) can awaken them early.\nâ€¢ Critical Failure: As Failure, and the target suffers groggy disorientation (â€“1 status penalty to all checks) for 10 minutes after waking.\nNotes: Tasteless when masked by spiced wine.",
    "craftDC": 20,
    "value": "50 gp",
    "usage": "1 dose (ingested)",
    "bulk": "-",
    "lore": [
      "Favored at masked courts where duels are fought with goblets, not blades.",
      "Recipes call for black poppy resin and moon-sifted sugar."
    ]
  },
  {
    "name": "Mind-Control Prism",
    "type": "Wondrous Item (Enchantment, Mental)",
    "level": 7,
    "traits": ["Magical", "Enchantment", "Mental", "Invested", "Uncommon"],
    "effect": "ðŸ”· Hypnotic Command Beam (1 action)\nProject a scintillant ray at a creature within 30 ft. Will DC 21.\nâ€¢ Failure: The target is controlled by you for up to 1 minute; it may attempt a new save at the end of each of its turns to end the effect.\nâ€¢ Success: Shaken lucidityâ€”no control, but the target is aware you attempted to sway them.\nâ€¢ Critical Success: The prism backlashes; you are dazzled for 1 round.\nLimits: After a use (regardless of outcome), the prism becomes inert until you complete daily preparations.\nTell: The crystalâ€™s facets slowly spiral like an eye when active.",
    "craftDC": 23,
    "usage": "Held or mounted on a gauntlet (invested)",
    "bulk": "L",
    "value": "Unknown â€” needs GM ruling",
    "lore": [
      "Cut from a vein of mindglass found in a dreaming quarry.",
      "Banned in three city-states; prized by interrogators and illusionists."
    ]
  }

    ];


    const tableBody = document.getElementById('item-table-body');
    const filter = document.getElementById('filter');
    const search = document.getElementById('search');

    function renderTable(items) {
      tableBody.innerHTML = '';
      items.forEach((item, index) => {
        const row = document.createElement('tr');
        row.classList.add('expandable');
        row.onclick = () => {
          const next = row.nextElementSibling;
          if (next && next.classList.contains('details')) {
            next.style.display = next.style.display === 'table-row' ? 'none' : 'table-row';
          }
        };

        row.innerHTML = `
          <td><strong class="item-name">${item.name}</strong></td>
          <td>${item.type}</td>
          <td>${item.level ?? 'â€”'}</td>
          <td>${item.effect.split("\n")[0]}</td>
          <td>${item.craftDC ?? 'â€”'}</td>
        `;

        const detailRow = document.createElement('tr');
        detailRow.className = 'details';
        let extraDetails = '';
        if (item.baseWeapon) extraDetails += `<div><span class='detail-label'>Base Weapon:</span> ${item.baseWeapon}</div>`;
        if (item.damage) extraDetails += `<div><span class='detail-label'>Damage:</span> ${item.damage}</div>`;
        if (item.attackBonus) extraDetails += `<div><span class='detail-label'>Attack Bonus:</span> ${item.attackBonus}</div>`;
        if (item.group) extraDetails += `<div><span class='detail-label'>Weapon Group:</span> ${item.group}</div>`;
        if (item.proficiency) extraDetails += `<div><span class='detail-label'>Proficiency:</span> ${item.proficiency}</div>`;
        if (item.traits) extraDetails += `<div><span class='detail-label'>Traits:</span> ${item.traits.join(', ')}</div>`;
        if (item.bulk) extraDetails += `<div><span class='detail-label'>Bulk:</span> ${item.bulk}</div>`;
        if (item.usage) extraDetails += `<div><span class='detail-label'>Usage:</span> ${item.usage}</div>`;

        detailRow.innerHTML = `<td colspan="5">${extraDetails}<br><br>${item.effect.replaceAll('\n', '<br>')}</td>`;

        tableBody.appendChild(row);
        tableBody.appendChild(detailRow);
      });
    }

    function filterAndSearch() {
      const type = filter.value.toLowerCase();
      const term = search.value.toLowerCase();
      const filtered = itemData.filter(item => {
        return (!type || item.type.toLowerCase().includes(type)) &&
               (!term || item.name.toLowerCase().includes(term));
      });
      renderTable(filtered);
    }

    function sortTable(columnIndex) {
      const key = ['name', 'type', 'level', null, 'craftDC'][columnIndex];
      if (!key) return;
      itemData.sort((a, b) => {
        if (a[key] == null) return 1;
        if (b[key] == null) return -1;
        return a[key] > b[key] ? 1 : -1;
      });
      filterAndSearch();
    }

    filter.addEventListener('change', filterAndSearch);
    search.addEventListener('input', filterAndSearch);

    renderTable(itemData);
  </script>
</body>
</html>
