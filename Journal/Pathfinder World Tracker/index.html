<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Iron Meridian Campaign Tracker</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="dist/css/main.min.css">
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar Navigation -->
            <nav class="col-md-3 col-lg-2 d-md-block sidebar collapse" style="background-color: var(--bg-dark);">
                <div class="position-sticky pt-3">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link active text-accent" href="#dashboard">
                                <i class="fas fa-tachometer-alt me-2"></i>Dashboard
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text" href="#quests">
                                <i class="fas fa-scroll me-2"></i>Quests
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text" href="#players">
                                <i class="fas fa-users me-2"></i>Players
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text" href="#characters">
                                <i class="fas fa-user-shield me-2"></i>Characters
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text" href="#loot">
                                <i class="fas fa-coins me-2"></i>Loot & Curses
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text" href="#locations">
                                <i class="fas fa-map-marked-alt me-2"></i>Locations
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text" href="#notes">
                                <i class="fas fa-book me-2"></i>Backstories & Notes
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text" href="#guild">
                                <i class="fas fa-shield-alt me-2"></i>Guild Logs
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text" href="#factions">
                                <i class="fas fa-flag me-2"></i>Factions
                            </a>
                        </li>
                        <li class="nav-item mt-4">
                            <a class="nav-link text" href="#" data-bs-toggle="modal" data-bs-target="#dataManagementModal">
                                <i class="fas fa-database me-2"></i>Data Management
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- Main Content Area -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div id="content" class="content-area">
                    <!-- Dashboard Section -->
                    <div id="dashboard" class="section">
                        <h1 class="text-accent">Welcome to Iron Meridian Campaign Tracker</h1>
                        <p class="text">Select a section from the sidebar to begin managing your campaign.</p>
                        
                        <div class="row mt-4">
                            <div class="col-md-4">
                                <div class="card shadow-accent">
                                    <div class="card-body bg-card">
                                        <h5 class="card-title text-accent"><i class="fas fa-scroll me-2"></i>Active Quests</h5>
                                        <p class="card-text text" id="activeQuestsCount">Loading...</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card shadow-accent">
                                    <div class="card-body bg-card">
                                        <h5 class="card-title text-accent"><i class="fas fa-users me-2"></i>Party Members</h5>
                                        <p class="card-text text" id="partyMembersCount">Loading...</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card shadow-accent">
                                    <div class="card-body bg-card">
                                        <h5 class="card-title text-accent"><i class="fas fa-map-marked-alt me-2"></i>Locations Discovered</h5>
                                        <p class="card-text text" id="locationsCount">Loading...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Quests Section -->
                    <div id="quests" class="section">
                        <div class="row">
                            <!-- Quest List -->
                            <div class="col-md-4">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <h2 class="text-accent">Quests</h2>
                                    <button id="addQuestBtn" class="btn btn-primary">
                                        <i class="fas fa-plus"></i> Add Quest
                                    </button>
                                </div>
                                <div class="input-group mb-3">
                                    <span class="input-group-text"><i class="fas fa-search"></i></span>
                                    <input type="text" id="questSearch" class="form-control" placeholder="Search quests...">
                                </div>
                                <div id="questList" class="list-group" style="max-height: 600px; overflow-y: auto;">
                                    <!-- Quests will be loaded here -->
                                </div>
                            </div>
                            <!-- Quest Details -->
                            <div class="col-md-8">
                                <div id="questDetails" class="card h-100">
                                    <div class="empty-state">
                                        <i class="fas fa-scroll fa-3x mb-3"></i>
                                        <p class="empty-state-message">Select a quest to view details</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Players Section -->
                    <div id="players" class="section">
                        <div class="row">
                            <!-- Player List -->
                            <div class="col-md-4">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <h2 class="text-accent">Players</h2>
                                    <button id="addPlayerBtn" class="btn btn-primary">
                                        <i class="fas fa-plus"></i> Add Player
                                    </button>
                                </div>
                                <div class="input-group mb-3">
                                    <span class="input-group-text"><i class="fas fa-search"></i></span>
                                    <input type="text" id="playerSearch" class="form-control" placeholder="Search players...">
                                </div>
                                <div id="playerList" class="list-group" style="max-height: 600px; overflow-y: auto;">
                                    <!-- Players will be loaded here -->
                                </div>
                            </div>
                            <!-- Player Details -->
                            <div class="col-md-8">
                                <div id="playerDetails" class="card h-100">
                                    <div class="empty-state">
                                        <i class="fas fa-user-friends fa-3x mb-3"></i>
                                        <p class="empty-state-message">Select a player to view details</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Loot Section -->
                    <div id="loot" class="section">
                        <div class="loot-container">
                            <!-- Loot Filters -->
                            <div class="loot-filters">
                                <div class="loot-filters__search">
                                    <div class="input-group">
                                        <span class="input-group-text"><i class="fas fa-search"></i></span>
                                        <input type="text" id="lootItemSearch" class="form-control" placeholder="Search items..." data-search-type="loot">
                                    </div>
                                </div>
                                <div class="loot-filters__controls">
                                    <button id="addItemBtn" class="btn btn-primary">
                                        <i class="fas fa-plus me-2"></i>Add Item
                                    </button>
                                </div>
                            </div>

                            <div class="loot-content">
                                <!-- Item List -->
                                <div class="loot-list-container">
                                    <h2 class="section-title">Loot & Curses</h2>
                                    <div id="itemList" class="loot-list">
                                        <!-- Items will be loaded here -->
                                        <div class="loot-empty">
                                            <div class="loot-empty__icon">
                                                <i class="fas fa-coins"></i>
                                            </div>
                                            <p class="loot-empty__message">No items found</p>
                                            <button id="addFirstItemBtn" class="btn btn-primary">
                                                <i class="fas fa-plus me-2"></i>Add Your First Item
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Item Details -->
                                <div class="loot-details-container">
                                    <div id="itemDetails" class="loot-details">
                                        <div class="loot-empty">
                                            <i class="fas fa-coins fa-3x mb-3"></i>
                                            <p class="loot-empty__message">Select an item to view details</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        </div>
                    </div>

                    <!-- Locations Section -->
                    <div id="locations" class="section">
                        <div class="row">
                            <!-- Location List -->
                            <div class="col-md-4">
                                <!-- Header and buttons are dynamically added by LocationManager -->

                                <div class="input-group mb-3">
                                    <span class="input-group-text"><i class="fas fa-search"></i></span>
                                    <input type="text" id="locationSearch" class="form-control" placeholder="Search locations...">
                                </div>
                                <div id="locationList" class="list-group" style="max-height: 600px; overflow-y: auto;">
                                    <!-- Locations will be loaded here -->
                                </div>
                            </div>
                            <!-- Location Details -->
                            <div class="col-md-8">
                                <div id="locationDetails" class="card h-100">
                                    <div class="empty-state">
                                        <i class="fas fa-map-marker-alt fa-3x mb-3"></i>
                                        <p class="empty-state-message">Select a location to view details</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Notes Section -->
                    <div id="notes" class="section">
                        <div class="row">
                            <!-- Notes List -->
                            <div class="col-md-4">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <h2 class="text-accent">Backstories & Notes</h2>
                                    <button id="addNoteBtn" class="btn btn-primary">
                                        <i class="fas fa-plus"></i> Add Note
                                    </button>
                                </div>
                                <div class="input-group mb-3">
                                    <span class="input-group-text"><i class="fas fa-search"></i></span>
                                    <input type="text" id="noteSearch" class="form-control" placeholder="Search notes...">
                                </div>
                                <div id="noteList" class="list-group" style="max-height: 600px; overflow-y: auto;">
                                    <!-- Notes will be loaded here -->
                                </div>
                            </div>
                            <!-- Note Details -->
                            <div class="col-md-8">
                                <div id="noteDetails" class="card h-100">
                                    <div class="empty-state">
                                        <i class="fas fa-book fa-3x mb-3"></i>
                                        <p class="empty-state-message">Select a note to view details</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Guild Section -->
                    <div id="guild" class="section">
                        <h2>Guild Logs</h2>
                        <!-- Guild content will be added later -->
                    </div>

                    <!-- Factions Section -->
                    <div id="factions" class="section">
                        <div class="row">
                            <div class="col-12">
                                <div id="factions-container">
                                    <!-- Factions content will be loaded here -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Characters Section -->
                    <div id="characters" class="section">
                        <div class="row">
                            <!-- Character List -->
                            <div class="col-md-4">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <h2 class="text-accent">Characters</h2>
                                    <button id="addCharacterBtn" class="btn btn-primary">
                                        <i class="fas fa-plus"></i> Add Character
                                    </button>
                                </div>
                                <div class="input-group mb-3">
                                    <span class="input-group-text"><i class="fas fa-search"></i></span>
                                    <input type="text" id="characterSearch" class="form-control" placeholder="Search characters...">
                                </div>
                                <div id="characterList" class="list-group" style="max-height: 600px; overflow-y: auto;">
                                    <!-- Characters will be loaded here -->
                                </div>
                            </div>
                            
                            <!-- Character Details -->
                            <div class="col-md-8">
                                <div id="characterDetails" class="card h-100">
                                    <div class="empty-state">
                                        <i class="fas fa-user-shield fa-3x mb-3"></i>
                                        <p class="empty-state-message">Select a character to view details</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Modals and forms are now created dynamically by their respective modules -->

    <!-- Data Management Modal -->
    <div class="modal fade" id="dataManagementModal" tabindex="-1" aria-labelledby="dataManagementModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content bg-dark text-light">
                <div class="modal-header border-secondary">
                    <h5 class="modal-title text-accent" id="dataManagementModalLabel">
                        <i class="fas fa-database me-2"></i>Data Management
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-4">
                        <h6 class="text-accent mb-3">Export Data</h6>
                        <p class="text-muted small mb-3">Export all your campaign data to a JSON file for backup or transfer.</p>
                        <button id="exportDataBtn" class="btn btn-outline-primary w-100">
                            <i class="fas fa-file-export me-2"></i>Export All Data
                        </button>
                    </div>
                    
                    <div class="mb-3">
                        <hr class="border-secondary">
                        <h6 class="text-accent mb-3">Import Data</h6>
                        <p class="text-muted small mb-3">Import data from a previously exported JSON file. <strong class="text-warning">This will overwrite all current data!</strong></p>
                        <div class="input-group mb-3">
                            <input type="file" class="form-control bg-dark text-light border-secondary" id="importFileInput" accept=".json">
                            <button class="btn btn-outline-secondary" type="button" id="importDataBtn" disabled>
                                <i class="fas fa-file-import me-2"></i>Import
                            </button>
                        </div>
                        <div id="importStatus" class="small"></div>
                    </div>
                </div>
                <div class="modal-footer border-secondary">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JavaScript -->
    <script src="scripts/main.js" type="module"></script>
</body>
</html>